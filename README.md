# Ususama （烏枢沙摩）

![ususama1](https://user-images.githubusercontent.com/4201520/27992828-da035b2e-64d7-11e7-9a34-98a981637fd6.jpg)
![ususama3](https://user-images.githubusercontent.com/4201520/27992829-da058160-64d7-11e7-88cb-fe3d57447d8f.jpg)

## このプロジェクトについて

トイレ個室の空き状況を確認できるようにする、マルチメディア研究サークルの1プロジェクトです。

主担当は[伊藤](https://github.com/jujunjun110)と[いっちー](https://github.com/icchii0618)です。

ご意見・ご感想・ご要望などは、Slackの #toilet チャンネルまでお寄せ下さい。

## 問題意識

2016年ごろから、社員数の増加に伴い、混雑時にトイレの個室が埋まっておりなかなか利用できないケースが増えました。

このプロジェクトでは、トイレ個室の空き状況をセンサーで可視化し、自席などから確認できるようにすることにより、
トイレへの無駄足を避け、より**業務の生産性を高める**ことを目的にしています。

## 使い方

<span style="color: red">**※ 現状、ネットワークの状況によりうまく挙動しない場合があるようです。表示される情報が誤っていたらすみません。**</span>

現在、**6Fの男子トイレ個室のみが確認対象**になっています。

個室のドアの開閉状況に応じて、いっちーのSlackステータスが変化するので、トイレに行きたいと思った時に確認して使います。

![status](https://user-images.githubusercontent.com/4201520/27992859-a64bce96-64d8-11e7-93ed-f2056b506a9c.png)

↑これ。（**StarするとSlackサイドバーの上部に固定できて便利**！）

それぞれの絵文字が以下のことを意味します。

- ⭕ ... 個室2つとも空室
- ⚠️ ... 個室1つのみ空室
- ❌ ... どちらも満室

## 使っている機器
- [Raspberry Pi](https://ja.wikipedia.org/wiki/Raspberry_Pi)
- [近接センサー](https://www.pololu.com/product/2579)
- [Wifiドングル](https://www.amazon.co.jp/dp/B004AP8QKM)

## 機器の配置のイメージ
![機器の配置](https://user-images.githubusercontent.com/4201520/27769599-2bf55c72-5f68-11e7-9ef1-6f3e16c9fe3b.png)

## 処理の流れ
1. 近接センサーから、ドアの開閉を毎秒取得
2. 5秒間連続で、現在表示している状態と異なるドアの状態が取得されたら、Slack APIにHTTPリクエスト
3. 対象のアカウント（今のところいっちー）のSlack Statusがトイレの空き状況を表すものに変化する

## プライバシーについて
このプロジェクトで利用しているセンサーは**近接センサー**といい、赤外線によって「センサーから一定の距離に物があるかないか」を測定するもので、これによってドアの開閉を個室の空き状況として利用しています。

![ususama2](https://user-images.githubusercontent.com/4201520/27992827-da032cee-64d7-11e7-86ed-d99956c4cbbd.jpg)

近接センサーによって、**個人の特定や、人の動作の特定をすることはできない**のでご安心ください。

また、メインマシンとして利用しているRaspberyPiという小型コンピューターにも、カメラ・マイクといったセンサーは付いていないので、**システム全体としてプライバシー情報を取得することは不可能**な構成です。


## FAQ

### Q. なぜ6階からなの？別のトイレへの設置予定は？

A. 6階なのは伊藤が6階にいるから。しばらくうまく稼働できて、価値があると思う人が多かったら7F男子トイレにも設置したいと思っています。
女子トイレは...協力してくださる女子の方がいたら技術協力はしますが、今のところ予定なしです。

### Q. ビル管などへの許可は大丈夫？

A. 石田さんが話を付けてきてくださったので問題ありません。感謝😌

### Q. なんでSlackステータスなの？

A. トイレの空き状況確認するのに毎回何かをクリックするのも面倒なので、なるべく一発で確認しやすい場所としてちょうどよいかと思ったので。
ただ、Slackスマホアプリからだとキャッシュが効いていて、最新状況じゃないこともあるようなので、別の方法も考え中。
いい案がある人は教えてください。

### Q. プロジェクト名の由来は？

A. 密教における明王の一尊であり、火神・**厠の神**として信仰される**烏枢沙摩明王**（うすさまみょうおう）から。（[詳細](https://ja.wikipedia.org/wiki/%E7%83%8F%E6%9E%A2%E6%B2%99%E6%91%A9%E6%98%8E%E7%8E%8B)）

